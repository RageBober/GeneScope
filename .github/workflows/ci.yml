# .github/workflows/quality-ci.yml

name: Quality CI

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  quality:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - uses: actions/setup-python@v5
      with:
        python-version: "3.11"

    - run: pip install -r requirements.txt
    - run: pip install ruff black mypy bandit pytest pytest-cov

    - run: ruff check genoscope/
    - run: black --check genoscope/
    - run: mypy genoscope/
    - run: bandit -r genoscope -q
    - run: pytest --cov=genoscope --cov-report=xml

    - uses: codecov/codecov-action@v4
      with:
        token: ${{ secrets.CODECOV_TOKEN }}
        files: ./coverage.xml
